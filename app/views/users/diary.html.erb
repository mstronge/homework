<div id="list-users" class="large-12 columns">
  
  <%= render partial: 'date_header' %>

  <% if @lesson.blank? %>
    <table width="100%">
      <tr>
        <td colspan="2"><h3 align="center"><%= "No lesson for this day!" %></h3></td>
      </tr>
    </table>
  <% else %>
    <%= form_for(@lesson) do |f| %>
      <table width="100%">

        <tr>
          <td colspan="2"><h3 align="center"><%= f.object.name %></h3></td>
        </tr>

        <tr>
          <td rowspan="2">
            <%= f.label :must_be_practised %>
            <%= f.text_area :must_be_practised, size: "x12" %>
          </td>
          <td>Comments box for student/parent</td>
        </tr>
        <tr>
          <td>Hours</td>
        </tr>

        <tr>
          <td>
            <%= f.label :how_to_practise %>
            <%= f.text_area :how_to_practise, size: "x12" %>
          </td>
          <td>Comments box for Teacher</td>
        </tr>
        
        <tr>
          <td rowspan="4">
           
            <div class="field-item">
              <label>Resources:</label>
              <% @resources_all = @resources %>
              <% @resources = @lesson.resources %>
              <%= render partial: 'resources/available_resources', locals:{ local_hash: {mode: "embedded", parent_model_name: "lesson", table_id: "embedded_resources", checked: true}} %>
            </div>

            <span class="success button small radius" onclick="$('#ResourcesModal').arcticmodal()">add yet resource</span>
            <div style='display: none;'>
              <div id="ResourcesModal" class="box-modal">
                <div class="box-modal_close arcticmodal-close">close</div>
                  <div id="resources_modal">
                      <% @resources = @resources_all - @lesson.resources %>
                      <%= render partial: 'resources/available_resources', locals:{local_hash: {mode: "embedded", parent_model_name: "lesson"}} %>
                  </div>
                </div>
              </div>
            </div>
          </td>

          <td>
            <%= f.label :raiting %>
            <%= select('lesson', 'raiting', options_for_select(['normal','high', 'low'],f.object.raiting)) %>
          </td>
        </tr>

        <tr>
          <td>
            <div class="input-daterange input-group" id="datepicker">
            <div class="input-daterange" id="datepicker">
              <%= f.label :date_start %>
              <%= text_field_tag :lesson_date_start, @lesson.date_start.strftime("%d/%m/%Y"), name: "lesson[date_start]" %>
              <%= f.label :date_finish %>
              <%= text_field_tag :lesson_date_finish, @lesson.date_finish.strftime("%d/%m/%Y"), name: "lesson[date_finish]" %>
            </div>
            <script type="text/javascript">
              $('.input-daterange').datepicker({
                format: "dd/mm/yyyy",
                calendarWeeks: true,
                autoclose: true,
                todayHighlight: true
              });
              </script>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <%= f.label :status %>
            <%= select('lesson', 'status', options_for_select(['new','in progress', 'completed'], f.object.status)) %>
          </td>
        </tr>
      </table>

      <div class="field-item">
        <%= f.submit "Submit Changes", :class => "success button radius" %>
        <%= link_to "Cancel changes", lessons_path, :class => "cancel" %>
      </div>

    <% end %>
  <% end %>
</div>